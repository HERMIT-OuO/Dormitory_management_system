{"remainingRequest":"E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js!E:\\ICE\\VUE-ADMIN\\src\\pages\\Repair\\components\\MyCrud\\index.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"E:\\ICE\\VUE-ADMIN\\src\\pages\\Repair\\components\\MyCrud\\index.vue","mtime":1559225645662},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js","mtime":1558363759028}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n.table_header{\r\n  margin-bottom: 1em;\r\n  /* text-align: right; */\r\n}\r\n\r\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/Repair/components/MyCrud","sourcesContent":["<template>\r\n  <div >\r\n    <!-- title=\"D2 CRUD\" -->\r\n    <!-- add-mode\r\n      :add-button=\"addButton\" \r\n      :form-rules=\"formRules\"\r\n      -->\r\n      <!-- .filter(data => data.name.includes(myname) && data.id.includes(myid) && String(data.dorm_id).includes(mydormid)) -->\r\n      <!-- && String(data.id).includes(util.cookies.get('user-id')) -->\r\n    <d2-crud\r\n      ref=\"d2Crud\"\r\n      :columns=\"columns\"\r\n      :data=\"data.filter(data =>  String(data.userid).includes(myid) && data.text.includes(mytext) )\"\r\n      :options = \"options\"\r\n      selection-row\r\n      index-row\r\n      add-title=\"申请报修\"\r\n      :add-template = \"addTemplate\"\r\n      :edit-template= \"addTemplate\"\r\n      :add-rules= \"addRules\"\r\n      :rowHandle= \"rowHandle\"\r\n      :form-options= \"formOptions\"\r\n      :edit-rules = \"addRules\"\r\n      @row-add= \"handleRowAdd\"\r\n      @row-edit= \"handleRowEdit\"\r\n      @row-remove= \"handleRowRemove\"\r\n      @dialog-cancel=\"handleDialogCancel\"\r\n      @selection-change=\"handleSelectionChange\">\r\n      <div slot=\"header\" class=\"table_header\">\r\n          <el-input v-model=\"mytext\" placeholder=\"请输入要查找的保修内容\" suffix-icon=\"el-icon-search\" style=\"width:15em;margin-right:1.5em;\"></el-input>\r\n          <el-button  @click=\"addRow\"  icon=\"el-icon-circle-plus-outline\"   style=\"margin-left:65em;\">申请报修</el-button>\r\n      </div>\r\n      </d2-crud>\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n.table_header{\r\n  margin-bottom: 1em;\r\n  /* text-align: right; */\r\n}\r\n\r\n</style>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport D2Crud from '@d2-projects/d2-crud'\r\nimport axios from 'axios'\r\nimport Qs from 'qs'\r\nimport util from '@/libs/util'\r\n\r\nVue.use(D2Crud)\r\n\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      myid:'',\r\n      mytext:'',\r\n      nowuser:{},\r\n      columns: [\r\n        {\r\n          title: '学号',\r\n          key: 'userid',\r\n          width: '150'\r\n        },\r\n        {\r\n          title: '申诉人',\r\n          key: 'username',\r\n          width: '100'\r\n        },\r\n        {\r\n          title: '宿舍号',\r\n          key: 'dormid',\r\n          width: '100'\r\n        },\r\n        {\r\n          title: '报修内容',\r\n          key: 'text',\r\n          width: '350'\r\n        },\r\n        {\r\n          title: '状态',\r\n          key: 'statues',\r\n          width: '100',\r\n          filters: [\r\n            { text: '待处理', value: '待处理' },\r\n            { text: '正在处理', value: '正在处理' },\r\n            { text: '已处理', value: '已处理' }\r\n          ],\r\n          filterMethod (value, row) {\r\n            return row.statues === value\r\n          },\r\n          filterPlacement: 'bottom-end'\r\n        }\r\n      ],\r\n      data: [\r\n        \r\n      ],\r\n      addTemplate: {\r\n        userid: {\r\n          title: '学号',\r\n          value: util.cookies.get('user-id'),\r\n          component: {\r\n            span: 18\r\n          }\r\n        },\r\n        username: {\r\n          title: '姓名',\r\n          value: util.cookies.get('user-name'),\r\n          component: {\r\n            span: 18\r\n          }\r\n        },\r\n        dormid: {\r\n          title: '宿舍号',\r\n          value: util.cookies.get('user-dorm-id'),\r\n          component: {\r\n            span: 18\r\n          }\r\n        },\r\n        text: {\r\n          title: '报修内容',\r\n          value: '',\r\n          component: {\r\n            span:20\r\n          }\r\n        },\r\n      },\r\n      addRules: {\r\n        userid: [ { required: true, message: '请输入学号', trigger: 'blur' } ],\r\n        username: [ { required: true, message: '请输入姓名', trigger: 'blur' } ],\r\n        text:[{ required: true, message: '请输入报修内容', trigger: 'blur' }],\r\n        dormid:[ {required: true, message: '请输入宿舍号', trigger: 'blur'} ]\r\n      },\r\n      options: {\r\n        stripe:true,\r\n        highlightCurrentRow:true,\r\n        border:true\r\n      },\r\n      rowHandle: {\r\n        columnHeader: '操作',\r\n        remove: {\r\n          icon: 'el-icon-delete',\r\n          size: 'small',\r\n          fixed: 'right',\r\n          confirm: true\r\n        }\r\n      },\r\n      formOptions: {\r\n        labelWidth: '80px',\r\n        labelPosition: 'left',\r\n        saveLoading: false,\r\n        gutter: 20\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    addRow () {\r\n      this.$refs.d2Crud.showDialog({\r\n        mode: 'add'\r\n      })\r\n    },\r\n    handleRowAdd (row, done) {\r\n      this.formOptions.saveLoading = true\r\n      setTimeout(() => {\r\n        console.log(row)\r\n        this.$message({\r\n          message: '保存成功',\r\n          type: 'success'\r\n        });\r\n        done({statues:'待处理'})\r\n        this.addApp(row)\r\n        this.formOptions.saveLoading = false\r\n      }, 300);\r\n    },\r\n    handleRowEdit ({index, row}, done) {\r\n      this.formOptions.saveLoading = true\r\n      setTimeout(() => {\r\n        this.$message({\r\n          message: '编辑成功',\r\n          type: 'success'\r\n        })\r\n        done()\r\n        this.alterApp(row.text,temp)\r\n        this.formOptions.saveLoading = false\r\n      }, 300)\r\n    },\r\n    handleRowRemove ({index, row},done) {\r\n      setTimeout(() => {\r\n        this.$message({\r\n          message: '删除成功',\r\n          type: 'success'\r\n        })\r\n        done()\r\n        this.delApp(row)\r\n      }, 300)\r\n    },\r\n    handleDialogCancel (done) {\r\n      this.$message({\r\n        message: '取消保存',\r\n        type: 'warning'\r\n      });\r\n      done()\r\n    },\r\n    handleSelectionChange (selection) {\r\n      console.log(selection)\r\n    },\r\n    getStudent(userid){\r\n      var _this = this\r\n      axios.post('http://localhost:8080/GetOneStudent',Qs.stringify({id:userid}))\r\n        .then(function (response) {\r\n          console.log(response)\r\n          _this.nowuser = response.data\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n    addApp(row){\r\n      var _this = this\r\n      axios.post('http://localhost:8080/AddAppRow',Qs.stringify(row))\r\n        .then(function (response) {\r\n          console.log(response)\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n    getAllStudent(){\r\n      var _this = this\r\n      axios.get('http://localhost:8080/GetAllApp')\r\n        .then(function (response) {\r\n          console.log(response)\r\n          _this.data = response.data\r\n        })\r\n        .catch(function (error) {\r\n          console.log(error);\r\n        });\r\n    },\r\n    alterApp(text,temp){\r\n      axios.post('http://localhost:8080/AlterAppText',Qs.stringify({text:text,temp:temp}))\r\n      .then(function (response) {\r\n        console.log(response);\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n    },\r\n    delApp(row){\r\n      //删除某一行，获取当前行的ID，\r\n      axios.post('http://localhost:8080/DelAppRow',Qs.stringify({text:row.text}))\r\n      .then(function (response) {\r\n        console.log(response);\r\n      })\r\n      .catch(function (error) {\r\n        console.log(error);\r\n      });\r\n      \r\n    },\r\n  },\r\n  mounted(){\r\n    this.getAllStudent()\r\n    this.myid = util.cookies.get('user-id')\r\n    this.getStudent(this.myid)\r\n  }\r\n}\r\n\r\n</script>\r\n\n<vue-filename-injector>\nexport default function (Component) {\n  Component.options.__source = \"src/pages/Repair/components/MyCrud/index.vue\"\n}\n</vue-filename-injector>\n"]}]}