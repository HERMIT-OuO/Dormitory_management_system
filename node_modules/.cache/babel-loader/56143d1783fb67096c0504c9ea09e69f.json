{"remainingRequest":"E:\\ICE\\VUE-ADMIN\\node_modules\\thread-loader\\dist\\cjs.js!E:\\ICE\\VUE-ADMIN\\node_modules\\babel-loader\\lib\\index.js!E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js!E:\\ICE\\VUE-ADMIN\\src\\pages\\Student-management\\components\\D2Crud\\D2Crud.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ICE\\VUE-ADMIN\\src\\pages\\Student-management\\components\\D2Crud\\D2Crud.vue","mtime":1559294377590},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js","mtime":1558363759028}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Vue from 'vue';\nimport D2Crud from '@d2-projects/d2-crud';\nimport axios from 'axios';\nimport Qs from 'qs';\nVue.use(D2Crud);\nexport default {\n  data: function data() {\n    return {\n      myid: '',\n      myname: '',\n      mydormid: '',\n      columns: [{\n        title: '学号',\n        key: 'id',\n        width: '250'\n      }, {\n        title: '姓名',\n        key: 'name',\n        width: '180'\n      }, {\n        title: '宿舍号',\n        key: 'dorm_id',\n        width: '180'\n      }, {\n        title: '性别',\n        key: 'sex',\n        width: '180',\n        filters: [{\n          text: '男',\n          value: '男'\n        }, {\n          text: '女',\n          value: '女'\n        }],\n        filterMethod: function filterMethod(value, row) {\n          return row.sex === value;\n        },\n        filterPlacement: 'bottom-end'\n      }, {\n        title: '专业',\n        key: 'major',\n        width: '250'\n      }, {\n        title: '身份',\n        key: 'flag',\n        width: '180',\n        filters: [{\n          text: '舍员',\n          value: '舍员'\n        }, {\n          text: '舍长',\n          value: '舍长'\n        }],\n        filterMethod: function filterMethod(value, row) {\n          return row.flag === value;\n        },\n        filterPlacement: 'bottom-end'\n      }],\n      data: [],\n      table: {\n        header: {},\n        data: {}\n      },\n      options: {\n        stripe: true,\n        highlightCurrentRow: true,\n        border: true\n      },\n      addButton: {\n        icon: 'el-icon-plus',\n        size: 'small'\n      },\n      rowHandle: {\n        columnHeader: '学生管理',\n        edit: {\n          icon: 'el-icon-edit',\n          text: '编辑',\n          size: 'small'\n        },\n        remove: {\n          icon: 'el-icon-delete',\n          size: 'small',\n          fixed: 'right',\n          confirm: true\n        }\n      },\n      addTemplate: {\n        id: {\n          title: '学号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        sex: {\n          title: '性别',\n          value: '',\n          component: {\n            name: 'el-select',\n            options: [{\n              value: '男',\n              label: '男'\n            }, {\n              value: '女',\n              label: '女'\n            }],\n            clearable: true,\n            span: 12\n          }\n        },\n        name: {\n          title: '姓名',\n          value: '',\n          component: {\n            clearable: true,\n            span: 10\n          }\n        },\n        flag: {\n          title: '身份',\n          value: '',\n          component: {\n            name: 'el-select',\n            options: [{\n              value: '舍员',\n              label: '舍员'\n            }, {\n              value: '舍长',\n              label: '舍长'\n            }],\n            clearable: true,\n            span: 12\n          }\n        },\n        dorm_id: {\n          title: '宿舍号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        major: {\n          title: '专业',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        tel: {\n          title: '联系方式',\n          value: '',\n          component: {\n            span: 10\n          }\n        }\n      },\n      addRules: {\n        id: [{\n          required: true,\n          message: '请输入学号',\n          trigger: 'blur'\n        }],\n        name: [{\n          required: true,\n          message: '请输入姓名',\n          trigger: 'blur'\n        }],\n        sex: [{\n          required: true,\n          message: '请选择性别',\n          trigger: 'blur'\n        }],\n        flag: [{\n          required: true,\n          message: '请选择身份',\n          trigger: 'blur'\n        }],\n        major: [{\n          required: true,\n          message: '请输入专业',\n          trigger: 'blur'\n        }],\n        tel: [{\n          required: true,\n          message: '请输入电话号',\n          trigger: 'blur'\n        }],\n        dorm_id: [{\n          required: true,\n          message: '请输入宿舍号',\n          trigger: 'blur'\n        }]\n      },\n      formOptions: {\n        labelWidth: '80px',\n        labelPosition: 'left',\n        saveLoading: false,\n        gutter: 20\n      }\n    };\n  },\n  filters: {\n    searchStudent: function searchStudent(arr) {\n      var newData = [];\n\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i].id.indexOf(myid)) newData.pust(arr[i]);\n      }\n\n      return newData;\n    }\n  },\n  methods: {\n    //导出表格\n    exportExcel: function exportExcel() {\n      var _this2 = this;\n\n      var mycolumns = [{\n        label: '姓名',\n        prop: 'id'\n      }, {\n        label: '姓名',\n        prop: 'name'\n      }, {\n        label: '宿舍号',\n        prop: 'dorm_id'\n      }, {\n        label: '性别',\n        prop: 'sex'\n      }, {\n        label: '专业',\n        prop: 'major'\n      }, {\n        label: '身份',\n        prop: 'flag'\n      }];\n\n      var _this = this;\n\n      console.log(this.data);\n      this.$export.excel({\n        columns: mycolumns,\n        data: _this.data\n      }).then(function () {\n        _this2.$message('导出表格成功');\n      });\n    },\n    //导入表格\n    handleUpload: function handleUpload(file) {\n      var _this3 = this;\n\n      this.$import.xlsx(file).then(function (_ref) {\n        var header = _ref.header,\n            results = _ref.results;\n        _this3.table.columns = header.map(function (e) {\n          return {\n            label: e,\n            prop: e\n          };\n        });\n        _this3.table.data = results;\n\n        for (var i in results) {\n          _this3.data.push(results[i]);\n        }\n\n        _this3.uploadExcel(results);\n      });\n      return false;\n    },\n    //上传多条数据\n    uploadExcel: function uploadExcel(results) {\n      for (var i in results) {\n        this.AddStudent(results[i]);\n      }\n    },\n    // 普通的新增\n    addRow: function addRow() {\n      this.$refs.d2Crud.showDialog({\n        mode: 'add'\n      });\n    },\n    handleRowAdd: function handleRowAdd(row, done) {\n      var _this4 = this;\n\n      this.formOptions.saveLoading = true;\n      setTimeout(function () {\n        console.log(row);\n\n        _this4.$message({\n          message: '保存成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this4.AddStudent(row);\n\n        _this4.formOptions.saveLoading = false;\n      }, 300);\n    },\n    handleRowEdit: function handleRowEdit(_ref2, done) {\n      var _this5 = this;\n\n      var index = _ref2.index,\n          row = _ref2.row;\n      this.formOptions.saveLoading = true;\n      setTimeout(function () {\n        console.log(index);\n        console.log(row);\n\n        _this5.$message({\n          message: '编辑成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this5.alterStudent(row);\n\n        _this5.formOptions.saveLoading = false;\n      }, 300);\n    },\n    handleRowRemove: function handleRowRemove(_ref3, done) {\n      var _this6 = this;\n\n      var index = _ref3.index,\n          row = _ref3.row;\n      setTimeout(function () {\n        console.log(index);\n        console.log(row);\n\n        _this6.$message({\n          message: '删除成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this6.delStudent(row);\n      }, 300);\n    },\n    handleDialogCancel: function handleDialogCancel(done) {\n      this.$message({\n        message: '取消保存',\n        type: 'warning'\n      });\n      done();\n    },\n    handleSelectionChange: function handleSelectionChange(selection) {\n      console.log(selection);\n    },\n    getAllStudent: function getAllStudent() {\n      var _this = this;\n\n      axios.get('http://localhost:8080/GetAllStudent').then(function (response) {\n        console.log(response);\n        _this.data = response.data;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    AddStudent: function AddStudent(newStudent) {\n      axios.post('http://localhost:8080/AddStuRow', Qs.stringify(newStudent)).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    alterStudent: function alterStudent(newStudent) {\n      axios.post('http://localhost:8080/AlterStuRow', Qs.stringify(newStudent)).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    delStudent: function delStudent(ID) {\n      //删除某一行，获取当前行的ID，\n      axios.post('http://localhost:8080/DelStuRow', Qs.stringify({\n        id: ID.id\n      })).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n      console.log('删除了ID：' + ID);\n    },\n    findID: function findID() {}\n  },\n  mounted: function mounted() {\n    this.getAllStudent();\n  }\n};",{"version":3,"sources":["D2Crud.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div >\n    <!-- title=\"D2 CRUD\" -->\n    <!-- add-mode\n      :add-button=\"addButton\" \n      :form-rules=\"formRules\"\n      -->\n    <d2-crud\n      ref=\"d2Crud\"\n      :columns=\"columns\"\n      :data=\"data.filter(data => data.name.includes(myname) && data.id.includes(myid) && String(data.dorm_id).includes(mydormid))\"\n      :options = \"options\"\n      selection-row\n      index-row\n      add-title=\"添加学生\"\n      :add-template = \"addTemplate\"\n      :add-rules=\"addRules\"\n      :rowHandle=\"rowHandle\"\n      :form-options=\"formOptions\"\n      :edit-rules = \"addRules\"\n      :edit-template=\"addTemplate\"\n      @row-add=\"handleRowAdd\"\n      @row-edit=\"handleRowEdit\"\n      @row-remove=\"handleRowRemove\"\n      @dialog-cancel=\"handleDialogCancel\"\n      @selection-change=\"handleSelectionChange\">\n      <div slot=\"header\" class=\"table_header\">\n          <el-input v-model=\"myid\" placeholder=\"请输入要查找的学号\" suffix-icon=\"el-icon-search\" style=\"width:15em;margin-right:1.5em;\"></el-input>\n          <el-input v-model=\"myname\"  placeholder=\"请输入要查找的姓名\" suffix-icon=\"el-icon-search\" style=\"width:15em;margin-right:1.5em;\"></el-input>\n          <el-input v-model=\"mydormid\"  placeholder=\"请输入要查找的宿舍号\" suffix-icon=\"el-icon-search\" style=\"width:15em;margin-right:1.5em;\"></el-input>\n          <el-button   @click=\"addRow\"  icon=\"el-icon-circle-plus-outline\"   style=\"margin-left:40em;\">添加学生</el-button>\n          <el-upload :before-upload=\"handleUpload\" action=\"default\" style=\"display: inline-block; margin-left:1em\">\n            <el-button ><d2-icon name=\"file-o\"/> 导入表格</el-button>\n          </el-upload>\n          <el-button @click=\"exportExcel\" style=\"margin-left:1em\">\n            <d2-icon name=\"download\"/>\n            导出表格\n          </el-button>\n      </div>\n      </d2-crud>\n  </div>\n</template>\n\n<style>\n.table_header{\n  margin-bottom: 1em;\n  /* text-align: right; */\n}\n</style>\n\n<script>\nimport Vue from 'vue'\nimport D2Crud from '@d2-projects/d2-crud'\nimport axios from 'axios'\nimport Qs from 'qs'\n\nVue.use(D2Crud)\n\nexport default {\n  data() {\n    return {\n      myid:'',\n      myname:'',\n      mydormid:'',\n      columns: [\n        {\n          title: '学号',\n          key: 'id',\n          width: '250'\n        },\n        {\n          title: '姓名',\n          key: 'name',\n          width: '180'\n        },\n        {\n          title: '宿舍号',\n          key: 'dorm_id',\n          width: '180'\n        },\n        {\n          title: '性别',\n          key: 'sex',\n          width: '180',\n          filters: [\n            { text: '男', value: '男' },\n            { text: '女', value: '女' }\n          ],\n          filterMethod (value, row) {\n            return row.sex === value\n          },\n          filterPlacement: 'bottom-end'\n        },\n        {\n          title: '专业',\n          key: 'major',\n          width: '250'\n        },\n        {\n          title: '身份',\n          key : 'flag',\n          width : '180',\n          filters: [\n            { text: '舍员', value: '舍员' },\n            { text: '舍长', value: '舍长' }\n          ],\n          filterMethod (value, row) {\n            return row.flag === value\n          },\n          filterPlacement: 'bottom-end'\n        }\n      ],\n      data: [\n        \n      ],\n      table:{\n        header:{},\n        data:{}\n      },\n      options: {\n        stripe:true,\n        highlightCurrentRow:true,\n        border:true\n      },\n      addButton: {\n        icon: 'el-icon-plus',\n        size: 'small'\n      },\n      rowHandle: {\n        columnHeader: '学生管理',\n        edit: {\n          icon: 'el-icon-edit',\n          text: '编辑',\n          size: 'small',\n        },\n        remove: {\n          icon: 'el-icon-delete',\n          size: 'small',\n          fixed: 'right',\n          confirm: true,\n        }\n      },\n      addTemplate: {\n        id: {\n          title: '学号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        sex:{\n          title: '性别',\n          value: '',\n          component:{\n            name: 'el-select',\n            options: [\n              {\n                value: '男',\n                label: '男'\n              },\n              {\n                value: '女',\n                label: '女'\n              }\n            ],\n            clearable: true,\n            span: 12\n          }\n        },\n        name: {\n          title: '姓名',\n          value: '',\n          component: {\n            clearable: true,\n            span: 10\n          }\n        },\n        flag:{\n          title: '身份',\n          value:'',\n          component: {\n          name: 'el-select',\n            options: [\n              {\n                value: '舍员',\n                label: '舍员'\n              },\n              {\n                value: '舍长',\n                label: '舍长'\n              }\n            ],\n            clearable: true,\n            span: 12\n          }\n        },\n        dorm_id: {\n          title: '宿舍号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        major: {\n          title : '专业',\n          value: '',\n          component:{\n            span:10\n          }\n        },\n        tel: {\n          title: '联系方式',\n          value: '',\n          component: {\n            span:10\n          }\n        },\n        \n      },\n      addRules: {\n        id: [ { required: true, message: '请输入学号', trigger: 'blur' } ],\n        name: [ { required: true, message: '请输入姓名', trigger: 'blur' } ],\n        sex: [ { required: true, message: '请选择性别', trigger: 'blur' } ],\n        flag:[ { required: true, message: '请选择身份', trigger: 'blur' } ],\n        major: [ { required: true, message: '请输入专业', trigger: 'blur' } ],\n        tel:[{ required: true, message: '请输入电话号', trigger: 'blur' }],\n        dorm_id:[ {required: true, message: '请输入宿舍号', trigger: 'blur'} ]\n      },\n      formOptions: {\n        labelWidth: '80px',\n        labelPosition: 'left',\n        saveLoading: false,\n        gutter: 20\n      }\n    }\n  },\n  filters:{\n    searchStudent:function(arr){\n      var newData = []\n      for(var i=0;i<arr.length;i++){\n        if(arr[i].id.indexOf(myid))\n          newData.pust(arr[i])  \n      }\n      return newData\n    }\n  },\n  methods: {\n      //导出表格\n    exportExcel(){\n      const mycolumns = [\n        {\n          label: '姓名',\n          prop: 'id'\n        },\n        {\n          label: '姓名',\n          prop: 'name'\n        },\n        {\n          label: '宿舍号',\n          prop: 'dorm_id'\n        },\n        {\n          label: '性别',\n          prop: 'sex'\n        },\n        {\n          label: '专业',\n          prop: 'major'\n        },\n       {\n          label: '身份',\n          prop: 'flag'\n        }\n      ]\n      var _this = this\n      console.log(this.data)\n      this.$export.excel({\n        columns: mycolumns,\n        data: _this.data,\n      })\n        .then(() => {\n          this.$message('导出表格成功')\n        })\n    },\n      //导入表格\n    handleUpload(file){\n      this.$import.xlsx(file)\n        .then(({ header, results }) => {\n          this.table.columns = header.map(e => {\n            return {\n              label: e,\n              prop: e\n            }\n          })\n          this.table.data = results\n          for(var i in results)\n          {\n            this.data.push(results[i])\n          }\n          this.uploadExcel(results)\n        })\n      return false\n    },\n      //上传多条数据\n    uploadExcel(results){\n      for(var i in results)\n      {\n        this.AddStudent(results[i])\n      }\n    },\n      // 普通的新增\n    addRow () {\n      this.$refs.d2Crud.showDialog({\n        mode: 'add'\n      })\n    },\n    handleRowAdd (row, done) {\n      this.formOptions.saveLoading = true\n      setTimeout(() => {\n        console.log(row)\n        this.$message({\n          message: '保存成功',\n          type: 'success'\n        });\n        done()\n        this.AddStudent(row)\n        this.formOptions.saveLoading = false\n      }, 300);\n    },\n    handleRowEdit ({index, row}, done) {\n      this.formOptions.saveLoading = true\n      setTimeout(() => {\n        console.log(index)\n        console.log(row)\n        this.$message({\n          message: '编辑成功',\n          type: 'success'\n        })\n        done()\n        this.alterStudent(row)\n        this.formOptions.saveLoading = false\n      }, 300)\n    },\n    handleRowRemove ({index, row}, done) {\n      setTimeout(() => {\n        console.log(index)\n        console.log(row)\n        this.$message({\n          message: '删除成功',\n          type: 'success'\n        })\n        done()\n        this.delStudent(row)\n      }, 300)\n    },\n    handleDialogCancel (done) {\n      this.$message({\n        message: '取消保存',\n        type: 'warning'\n      });\n      done()\n    },\n    handleSelectionChange (selection) {\n      console.log(selection)\n    },\n    getAllStudent(){\n      var _this = this\n      axios.get('http://localhost:8080/GetAllStudent')\n        .then(function (response) {\n          console.log(response)\n          _this.data = response.data\n        })\n        .catch(function (error) {\n          console.log(error);\n        });\n    },\n    AddStudent(newStudent){\n      axios.post('http://localhost:8080/AddStuRow',Qs.stringify(newStudent))\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    },\n    alterStudent(newStudent){\n      axios.post('http://localhost:8080/AlterStuRow',Qs.stringify(newStudent))\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n    },\n    delStudent(ID){\n      //删除某一行，获取当前行的ID，\n      axios.post('http://localhost:8080/DelStuRow',Qs.stringify({id:ID.id}))\n      .then(function (response) {\n        console.log(response);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n      console.log('删除了ID：'+ID)\n      \n    },\n    findID(){\n\n    },\n  },\n  mounted(){\n    this.getAllStudent()\n  }\n}\n\n</script>\n\n<vue-filename-injector>\nexport default function (Component) {\n  Component.options.__source = \"src/pages/Student-management/components/D2Crud/D2Crud.vue\"\n}\n</vue-filename-injector>\n"],"sourceRoot":"src/pages/Student-management/components/D2Crud"}]}