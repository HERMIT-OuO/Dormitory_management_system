{"remainingRequest":"E:\\ICE\\VUE-ADMIN\\node_modules\\babel-loader\\lib\\index.js!E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js!E:\\ICE\\VUE-ADMIN\\src\\pages\\Student-management\\components\\D2Crud\\D2Crud.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\ICE\\VUE-ADMIN\\src\\pages\\Student-management\\components\\D2Crud\\D2Crud.vue","mtime":1559294377590},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\ICE\\VUE-ADMIN\\tools\\vue-filename-injector\\src\\lib\\injector.js","mtime":1558363759028}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Vue from 'vue';\nimport D2Crud from '@d2-projects/d2-crud';\nimport axios from 'axios';\nimport Qs from 'qs';\nVue.use(D2Crud);\nexport default {\n  data: function data() {\n    return {\n      myid: '',\n      myname: '',\n      mydormid: '',\n      columns: [{\n        title: '学号',\n        key: 'id',\n        width: '250'\n      }, {\n        title: '姓名',\n        key: 'name',\n        width: '180'\n      }, {\n        title: '宿舍号',\n        key: 'dorm_id',\n        width: '180'\n      }, {\n        title: '性别',\n        key: 'sex',\n        width: '180',\n        filters: [{\n          text: '男',\n          value: '男'\n        }, {\n          text: '女',\n          value: '女'\n        }],\n        filterMethod: function filterMethod(value, row) {\n          return row.sex === value;\n        },\n        filterPlacement: 'bottom-end'\n      }, {\n        title: '专业',\n        key: 'major',\n        width: '250'\n      }, {\n        title: '身份',\n        key: 'flag',\n        width: '180',\n        filters: [{\n          text: '舍员',\n          value: '舍员'\n        }, {\n          text: '舍长',\n          value: '舍长'\n        }],\n        filterMethod: function filterMethod(value, row) {\n          return row.flag === value;\n        },\n        filterPlacement: 'bottom-end'\n      }],\n      data: [],\n      table: {\n        header: {},\n        data: {}\n      },\n      options: {\n        stripe: true,\n        highlightCurrentRow: true,\n        border: true\n      },\n      addButton: {\n        icon: 'el-icon-plus',\n        size: 'small'\n      },\n      rowHandle: {\n        columnHeader: '学生管理',\n        edit: {\n          icon: 'el-icon-edit',\n          text: '编辑',\n          size: 'small'\n        },\n        remove: {\n          icon: 'el-icon-delete',\n          size: 'small',\n          fixed: 'right',\n          confirm: true\n        }\n      },\n      addTemplate: {\n        id: {\n          title: '学号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        sex: {\n          title: '性别',\n          value: '',\n          component: {\n            name: 'el-select',\n            options: [{\n              value: '男',\n              label: '男'\n            }, {\n              value: '女',\n              label: '女'\n            }],\n            clearable: true,\n            span: 12\n          }\n        },\n        name: {\n          title: '姓名',\n          value: '',\n          component: {\n            clearable: true,\n            span: 10\n          }\n        },\n        flag: {\n          title: '身份',\n          value: '',\n          component: {\n            name: 'el-select',\n            options: [{\n              value: '舍员',\n              label: '舍员'\n            }, {\n              value: '舍长',\n              label: '舍长'\n            }],\n            clearable: true,\n            span: 12\n          }\n        },\n        dorm_id: {\n          title: '宿舍号',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        major: {\n          title: '专业',\n          value: '',\n          component: {\n            span: 10\n          }\n        },\n        tel: {\n          title: '联系方式',\n          value: '',\n          component: {\n            span: 10\n          }\n        }\n      },\n      addRules: {\n        id: [{\n          required: true,\n          message: '请输入学号',\n          trigger: 'blur'\n        }],\n        name: [{\n          required: true,\n          message: '请输入姓名',\n          trigger: 'blur'\n        }],\n        sex: [{\n          required: true,\n          message: '请选择性别',\n          trigger: 'blur'\n        }],\n        flag: [{\n          required: true,\n          message: '请选择身份',\n          trigger: 'blur'\n        }],\n        major: [{\n          required: true,\n          message: '请输入专业',\n          trigger: 'blur'\n        }],\n        tel: [{\n          required: true,\n          message: '请输入电话号',\n          trigger: 'blur'\n        }],\n        dorm_id: [{\n          required: true,\n          message: '请输入宿舍号',\n          trigger: 'blur'\n        }]\n      },\n      formOptions: {\n        labelWidth: '80px',\n        labelPosition: 'left',\n        saveLoading: false,\n        gutter: 20\n      }\n    };\n  },\n  filters: {\n    searchStudent: function searchStudent(arr) {\n      var newData = [];\n\n      for (var i = 0; i < arr.length; i++) {\n        if (arr[i].id.indexOf(myid)) newData.pust(arr[i]);\n      }\n\n      return newData;\n    }\n  },\n  methods: {\n    //导出表格\n    exportExcel: function exportExcel() {\n      var _this2 = this;\n\n      var mycolumns = [{\n        label: '姓名',\n        prop: 'id'\n      }, {\n        label: '姓名',\n        prop: 'name'\n      }, {\n        label: '宿舍号',\n        prop: 'dorm_id'\n      }, {\n        label: '性别',\n        prop: 'sex'\n      }, {\n        label: '专业',\n        prop: 'major'\n      }, {\n        label: '身份',\n        prop: 'flag'\n      }];\n\n      var _this = this;\n\n      console.log(this.data);\n      this.$export.excel({\n        columns: mycolumns,\n        data: _this.data\n      }).then(function () {\n        _this2.$message('导出表格成功');\n      });\n    },\n    //导入表格\n    handleUpload: function handleUpload(file) {\n      var _this3 = this;\n\n      this.$import.xlsx(file).then(function (_ref) {\n        var header = _ref.header,\n            results = _ref.results;\n        _this3.table.columns = header.map(function (e) {\n          return {\n            label: e,\n            prop: e\n          };\n        });\n        _this3.table.data = results;\n\n        for (var i in results) {\n          _this3.data.push(results[i]);\n        }\n\n        _this3.uploadExcel(results);\n      });\n      return false;\n    },\n    //上传多条数据\n    uploadExcel: function uploadExcel(results) {\n      for (var i in results) {\n        this.AddStudent(results[i]);\n      }\n    },\n    // 普通的新增\n    addRow: function addRow() {\n      this.$refs.d2Crud.showDialog({\n        mode: 'add'\n      });\n    },\n    handleRowAdd: function handleRowAdd(row, done) {\n      var _this4 = this;\n\n      this.formOptions.saveLoading = true;\n      setTimeout(function () {\n        console.log(row);\n\n        _this4.$message({\n          message: '保存成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this4.AddStudent(row);\n\n        _this4.formOptions.saveLoading = false;\n      }, 300);\n    },\n    handleRowEdit: function handleRowEdit(_ref2, done) {\n      var _this5 = this;\n\n      var index = _ref2.index,\n          row = _ref2.row;\n      this.formOptions.saveLoading = true;\n      setTimeout(function () {\n        console.log(index);\n        console.log(row);\n\n        _this5.$message({\n          message: '编辑成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this5.alterStudent(row);\n\n        _this5.formOptions.saveLoading = false;\n      }, 300);\n    },\n    handleRowRemove: function handleRowRemove(_ref3, done) {\n      var _this6 = this;\n\n      var index = _ref3.index,\n          row = _ref3.row;\n      setTimeout(function () {\n        console.log(index);\n        console.log(row);\n\n        _this6.$message({\n          message: '删除成功',\n          type: 'success'\n        });\n\n        done();\n\n        _this6.delStudent(row);\n      }, 300);\n    },\n    handleDialogCancel: function handleDialogCancel(done) {\n      this.$message({\n        message: '取消保存',\n        type: 'warning'\n      });\n      done();\n    },\n    handleSelectionChange: function handleSelectionChange(selection) {\n      console.log(selection);\n    },\n    getAllStudent: function getAllStudent() {\n      var _this = this;\n\n      axios.get('http://localhost:8080/GetAllStudent').then(function (response) {\n        console.log(response);\n        _this.data = response.data;\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    AddStudent: function AddStudent(newStudent) {\n      axios.post('http://localhost:8080/AddStuRow', Qs.stringify(newStudent)).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    alterStudent: function alterStudent(newStudent) {\n      axios.post('http://localhost:8080/AlterStuRow', Qs.stringify(newStudent)).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n    },\n    delStudent: function delStudent(ID) {\n      //删除某一行，获取当前行的ID，\n      axios.post('http://localhost:8080/DelStuRow', Qs.stringify({\n        id: ID.id\n      })).then(function (response) {\n        console.log(response);\n      }).catch(function (error) {\n        console.log(error);\n      });\n      console.log('删除了ID：' + ID);\n    },\n    findID: function findID() {}\n  },\n  mounted: function mounted() {\n    this.getAllStudent();\n  }\n};",null]}